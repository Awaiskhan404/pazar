{% extends 'base.html' %}

{% block title %}Search Results |
{% endblock title %}

{% block css %}
.card-text{
    font-family: charter, Georgia, Cambria, "Times New Roman", Times, serif;
}
.add-to-cart{
  background: #ff9f1a;
  padding: 0.7em 1.2em;
  border: none;
  font-weight: bold;
  color: #000;
  -webkit-transition: background .3s ease;
          transition: background .3s ease; 
}

.add-to-cart:hover{
    background: #b36800;
    color: #fff; 
}

div.rating {
    width: 160px;
}

input.star {
    display: none
}

label.star {
    float: right;
    padding: 0 3px;
    font-size: 23px;
    color: #4A148C;
    transition: all .2s
}

input.star:checked~label.star:before {
    content: '\f005';
    color: #FD4;
    transition: all .25s
}

input.star-5:checked~label.star:before {
    color: #FE7;
    text-shadow: 0 0 20px #952
}

input.star-1:checked~label.star:before {
    color: #F62
}

label.star:hover {
    transform: rotate(-15deg) scale(1.3)
}

label.star:before {
    content: '\f006';
    font-family: FontAwesome
}

.yellow-fill{
  color:#ffc107;
}
.item-card img{
  height:150px;
  width:100%;
}

.item{
  padding-left:5px;
  padding-right:5px;
}
.item-card{
  transition:0.5s;
  cursor:pointer;
}
.item-card-title{  
  font-size:15px;
  transition:1s;
  cursor:pointer;
}
.item-card-title i{  
  font-size:15px;
  transition:1s;
  cursor:pointer;
  color:#ffa710
}
div#main-card {
    max-width: 300px;
    box-shadow: -5px 2px 18px 4px #ccc;
    font-family: Comic Sans MS;
}

.cover-photo {
    background: #0ab581;
    width: 300px;
    height: 100px;
    position:relative;
}

.photo {
    background: #f9f9f9;
    width: 300px;
    height: 100px;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-pack: center;
    -ms-flex-pack: center;
    justify-content: center;
}
#main-card img {
    position: relative;
    top: -50px;
    max-width: 100%;
    max-height: 100%;
    border-radius: 50%;
    box-shadow: -1px 1px 11px 6px rgba(189, 172, 172, 0.33);
}
.content {
    background: #f9f9f9;
    width: 300px;
    height: 130px;
    position: relative;
    top: -35px;
}

.contact {
    background: #30354d;
    width: 300px;
    height: 50px;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-pack: center;
    -ms-flex-pack: center;
    justify-content: center;
    -webkit-box-align: center;
    -ms-flex-align: center;
    align-items: center;
}

h2.name,
#main-card h3,
#main-card a {
    margin: 0;
    text-align: center;
}

h3.fullstack {
    padding-bottom: 10px;
}

#main-card a {
    color: #0ab581;
    text-decoration: none;
}

#main-card a:hover {
    color: black;
}

#main-card ul {
    padding: 0;
}

#main-card .fa {
    font-size: 22px;
    padding: 10px;
    text-decoration: none;
    color: #0ab581;
}

#main-card .fa:hover {
    color: #000;
}

#main-card .fab {
    font-size: 22px;
    padding: 10px;
    text-decoration: none;
    color: #0ab581;
}

#main-card .fab:hover {
    color: #000;
}

#main-card .fas {
    font-size: 22px;
    padding: 10px;
    text-decoration: none;
    color: #0ab581;
}

#main-card .fas:hover {
    color: #000;
}

div#main-card:hover {
    -webkit-animation-name: pulse;  
    animation-name: pulse;
    -webkit-animation-duration: 2s;
    animation-duration: 2s;
    -webkit-animation-fill-mode: both;
    animation-fill-mode: both;
}
    @-webkit-keyframes pulse {
    0% {
        -webkit-transform: scale3d(1, 1, 1);
        transform: scale3d(1, 1, 1);
    }
    50% {
        -webkit-transform: scale3d(1.05, 1.05, 1.05);
        transform: scale3d(1.05, 1.05, 1.05);
    }
    100% {
        -webkit-transform: scale3d(1, 1, 1);
        transform: scale3d(1, 1, 1);
    }
}
    @keyframes pulse {
    0% {
        -webkit-transform: scale3d(1, 1, 1);
        transform: scale3d(1, 1, 1);
    }
    50% {
        -webkit-transform: scale3d(1.05, 1.05, 1.05);
        transform: scale3d(1.05, 1.05, 1.05);
    }
    100% {
        -webkit-transform: scale3d(1, 1, 1);
        transform: scale3d(1, 1, 1);
    }
} 
.stats {
	float: left;
    display:flex;
    flex-direction:row;
    margin-top:1rem;
}
	
	.box {
		box-sizing: border-box;
		width: 100px;
		height: 99px;
		background: #F5E8DF;
		text-align: center;
		padding-top: 28px;
		transition: all .4s ease-in-out;
    }
		.box:hover {
			background: #E1CFC2;
			cursor: pointer;
		}
		
		
	
	.box span {
		display: block;
	}
	
	.value {
		font-size: 18px;
		font-weight: 600;
	}
	
	.parameter {
		font-size: 11px;
	}
hr{
    margin:1rem;
}
{% endblock css %}

{% block body %}
<div class="container mt-5 p-5">
    <h2 class="text-center text-uppercase fw-bold text-dark mt-3 mb-3 fs-3" style="font-family:sans-serif;">Search results for <b class="text-primary" style="font-family:calibri;">{{query}}</b> : </h2>
    {% if cats|length < 1 and subcats|length < 1 and listings|length < 1 and sale|length < 1 and profiles|length < 1 and products|length < 1 %}
   <p><i class="fs-5">No search results</i></p>
    <i>Your search query:</i> <b>{{query}}</b> did not match any documents.<br>
    <b>Suggestions:</b>
    <ul style="font-family: 'Calibri', sans-serif;">
        <li>Make sure that all words are spelled correctly.</li>
        <li>Try more general keywords.</li>
        <li> Try fewer keywords.</li>
        <li> Try different keywords.</li>
    </ul>
    {% endif %}
    <div class="album py-5">
        <div class="container">
            <div class="row">
                {% for cat in cats %}
                    <div class="col-md-4">
                        <div class="card mb-4 shadow p-3">
                            {% if cat.image %}
                            <img src="{{cat.image.url}}" class="d-block w-100" alt="">
                            {% endif %}
                            <div class="card-body">
                            <h3 class="card-title fw-bold">{{cat.name}}</h3>
                            <p class="card-text">{{cat.description}}</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="btn-group">
                                <a href="{% url 'category-detail' cat.id cat.slug %}" style='font-family:calibri;'><button type="button" class="btn btn-sm btn-primary mt-2">View</button></a>
                                </div>
                            </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row">
            {% for cat in subcats %}
                <div class="col-md-4">
                    <div class="card mb-4 shadow p-3">
                        {% if cat.image %}
                            <img src="{{cat.image.url}}" class="d-block w-100" alt="">
                        {% endif %}
                        <div class="card-body">
                            <h3 class="card-title fw-bold">{{cat.name}}</h3>
                            <p class="card-text">{{cat.description}}</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="btn-group">
                                    <a href="{% url 'subcategory-detail' cat.id cat.slug %}" style='font-family:calibri;'><button type="button" class="btn btn-sm btn-primary mt-2">View</button></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
<div class="container mt-3">
  <div class="row">
    <div class="col-12 col-md-12">
      {% for listing in listings %}
            <div class="card mb-3 border-0 shadow" style="max-width: 1500px;">
                <div class="row g-0">
                    <div class="col-md-4 p-2">
                        <img src="{{listing.Business_Logo.url}}" alt="{{listing.Business_Name}}" class="img-fluid shadow-sm rounded img-responsive" style="height:100%;width:100%;">
                    </div>
                    <div class="col-md-8">
                        <div class="card-body">
                            <div class="row d-flex justify-content-between align-items-center">
                                <div class="col-7">
                                    <a href="{{listing.Listed_by.profile.get_absolute_url}}"><span class="text-muted"><img src="{{listing.Listed_by.profile.pic.url}}" style="height:30px;width:30px;display:inline-block;" class="rounded-circle"><small style="font-size:1.1rem;font-family: 'Redressed', cursive;" class="ml-2 text-info">{{listing.Listed_by.get_full_name}}</small></span></a>
                                    <h5 class="card-title h4 text-dark mb-0" style="font-family: 'Cormorant', serif;">{{listing.Business_Name}}</h5>
                                    <div class="rating">
                                        <div class="stars">
                                            <i class="{% if listing.averagereview < 1 %}far fa-star {% else %}fas fa-star yellow-fill{% endif %}"></i>
                                            <i class="{% if listing.averagereview < 2 %}far fa-star {% else %}fas fa-star yellow-fill{% endif %}"></i>
                                            <i class="{% if listing.averagereview < 3 %}far fa-star {% else %}fas fa-star yellow-fill{% endif %}"></i>
                                            <i class="{% if listing.averagereview < 4 %}far fa-star {% else %}fas fa-star yellow-fill{% endif %}"></i>
                                            <i class="{% if listing.averagereview < 5 %}far fa-star {% else %}fas fa-star yellow-fill{% endif %}"></i>
                                            <span><button class="btn-success text-light btn-sm" style="user-select:none;">{{listing.averagereview | stringformat:".2f"}}</button></span>
                                        </div>                                        
                                    </div>
                                    <small class="text-secondary"><i class="far fa-clock mr-2"></i>{{listing.Listed_at|timesince}} ago</small>&nbsp
                                    <small class="text-secondary"><i class="far fa-eye mr-1"></i>{{listing.view}}</small>                                    
                                </div>
                                <div class="col-5 d-flex justify-content-end">
                                    <a href="tel:{{listing.Business_Telephone}}" class="btn btn-light ml-3" data-toggle="tooltip" data-bs-placement="bottom" title="Call Us"><i class="fas fa-phone-alt fa-2x" style="color:blue;"></i></a>
                                    <a href="mailto:{{listing.Business_Email}}" class="btn btn-light ml-3" data-toggle="tooltip" data-bs-placement="bottom" title="Mail Us"><i class="fas fa-envelope-open-text fa-2x"></i></a>
                                    <a href="https://api.whatsapp.com/send?phone=91{{listing.Business_WhatsApp}}&text=Hello%20{{listing.Listed_by.get_full_name}}%20!%20I %20want%20to%20talk%20to%20you.%20Please%20respond." class="btn btn-light ml-3" data-toggle="tooltip" data-bs-placement="bottom" title="What's App Us"><i class="fab fa-whatsapp fa-2x" style="color: #4fce5d;"></i></a>
                                </div>
                            </div>
                            <p>{{listing.Business_Category.get_html_badge}}</p>
                            <p class="text-secondary mt-2 mb-2" style="font-family: 'Slabo 27px', serif;"><i class="fas fa-hashtag mr-3 text-info"></i>
                            {% for i in listing.Business_Subcategory.all %}
                            {{i.name}}{% if not forloop.last %},{% endif %}
                            {% endfor %}
                            </p>                            
                            <p class="text-secondary mb-2" style="font-family: 'Slabo 27px', serif;"><i class="fas fa-phone-square-alt mr-3 text-info"></i>{{listing.Business_Telephone}}</p>
                            <p class="text-secondary mb-2" style="font-family: 'Slabo 27px', serif;"><i class="fas fa-location-arrow mr-3 text-info"></i>{% if listing.Address %}{{listing.Address}}{% else %}{{listing.Business_Address}}{% endif %}</p>                            
                            <p class="card-text mb-2" style="font-family: 'Roboto', sans-serif;">{{listing.Business_Description|truncatewords:25}}</p>
                            <a class="btn add-to-cart" type="button" href="{% url 'listing-detail' listing.id listing.slug %}">View</a>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
    </div>
  </div>
</div>
    <div class="container mt-2">
        <div class="row">
            {% for item in sale %}
                <div class="col-md-3 col-sm-6 item">
                    <div class="card item-card card-block p-3 mr-3 mb-3">
                        <h4 class="card-title text-right"><span class="badge">{{item.category.get_html_badge}}</span></h4>
                        <img src="{{item.image.url}}" alt="Photo of item">
                        <h5 class="item-card-title mt-3 mb-3"><b>{{item.name}}</b>&nbsp;&nbsp;  • Price - <i class="fas fa-rupee-sign mr-1"></i><b>{{item.price}}</b></h5>
                        <p class="card-text" style="font-family:calibri;">{{item.description|truncatechars:100}}</p>
                        <div class="d-inline-flex">
                        <a href="{% url 'item-detail' item.pk item.slug %}"><button class="btn btn-warning btn-sm mt-3 mr-3"><i class="fas fa-eye text-dark mr-1"></i>View</button></a>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
    <div class="container mt-3">
        {% for profile in profiles %}
        <div id="main-card" class="rounded">
            <div class="cover-photo rounded-top"><a href="{{profile.get_absolute_url}}"><span style="position:absolute;top:10px;right:10px;"><i class="fas fa-arrow-right text-light"></i></span></a></div>
            <div class="photo">
                <img src="{{profile.pic.url}}" alt="{{profile.name}}">
            </div>
            <div class="content">
                    <h2 class="name fw-bold fs-5">{{profile.name}}</h2>
                    <h3 class="fullstack text-muted">{{profile.bio}}</h3>
                    <h3 class="email">
                        <a href="mailto:{{profile.user.email}}"><i class="far fa-envelope mr-1"></i>{{profile.user.email}}</a><br>
                        <a href="tel:{{profile.phone_no}}"><i class="fas fa-phone-square-alt mr-1"></i>{{profile.phone_no}}</a>
                    </h3>
                    <div class="d-flex flex-wrap mb-2">
                        {% for skill in profile.user.skill_set.all %}
                            <span class="badge bg-primary mt-2 ml-2 mr-2 mb-2">{{skill.name}}</span>
                        {% endfor %}
                    </div>
             </div>
            <div class="stats">
                {% if profile.user.is_shop_owner %}
                    <div class="box">
                        <span class="value">{{profile.user.free_listing_set.all.count}}</span>
                        <span class="parameter">Shops</span>
                    </div>
                    <div class="box">
                        <span class="value">{{profile.user.product_set.all.count}}</span>
                        <span class="parameter">Products</span>
                    </div>
                    <div class="box">
                        <span class="value">{{profile.user.customer_set.all.count}}</span>
                        <span class="parameter">Customers</span>
                    </div>
                {% endif %}
            </div>
            <div class="stats">
                {% if profile.user.is_user %}
                    <div class="box">
                        <span class="value">{{profile.user.blog_set.all.count}}</span>
                        <span class="parameter">Blogs</span>
                    </div>
                    <div class="box">
                        <span class="value">{{profile.user.post_set.all.count}}</span>
                        <span class="parameter">Posts</span>
                    </div>
                    <div class="box">
                        <span class="value">{{profile.followerCount}}</span>
                        <span class="parameter">Followers</span>
                    </div>
                {% endif %}
            </div>
            <div class="contact rounded-bottom">
                    <ul>
                        {% if profile.facebook %}
                        <a href="{{profile.facebook}}" target="_blank">
                            <i class="fab fa-facebook-square"></i>
                        </a>
                        {% endif %}
                        {% if profile.instagram %}
                        <a href="{{profile.instagram}}" target="_blank">
                            <i class="fab fa-instagram"></i>
                        </a>
                        {% endif %}
                        {% if profile.twitter %}
                        <a href="{{profile.twitter}}" target="_blank">
                            <i class="fab fa-twitter-square"></i>
                        </a>
                        {% endif %}
                        {% if profile.linkedin %}
                        <a href="{{profile.linkedin}}" target="_blank">
                            <i class="fa fa-linkedin"></i>
                        </a>
                        {% endif %}
                        {% if profile.github %}
                        <a href="{{profile.github}}" target="_blank">
                            <i class="fa fa-github"></i>
                        </a>
                        {% endif %}
                    </ul>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
<div class="container mt-3">
  <div class="d-flex flex-wrap">
    {% for product in products %}
            <div class="card mb-3 mr-3" style="width: 18rem;">
                <img src="{{product.image.url}}" alt="{{product.name}}" class="card-img-top">
                <div class="card-body">
                    <h3 class="card-title text-primary">{{product.name}}</h3>
                    <p class="card-text">{{product.desc}}</p>
                    <hr>
                    <h6 class="mb-0">
                        <span class="badge bg-danger text-light rounded-pill">&#8377;{{product.offer_price}}</span>
                        <span class="text-grey"><s>&#8377;{{product.price}}</s></span>
                    </h6>
                </div>
                <div class="card-footer">
                    <small class="text-muted">{{product.date|date:"F j, Y"}}</small>
                    <a href="{% url 'delete-product' product.id %}" class="btn btn-danger float-right ml-2 btn-sm"><i class="fas fa-trash"></i></a>
                    <a href="{% url 'edit-product' product.id %}" class="btn btn-success float-right btn-sm"><i class="fas fa-edit"></i></a>
                </div>
            </div>
        {% endfor %}
    </div>
</div>
{% endblock body %}
